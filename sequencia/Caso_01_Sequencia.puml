@startuml

actor Administrador
participant ":TelaCadastro" as TC <<boundary>>
participant ":CadastroController" as CC <<controller>>
participant ":UsuarioFactory" as UF
participant ":UsuarioRepository" as UR <<repository>>
participant ":Usuario" as U <<interface>>

== Cadastrar Usuário ==

Administrador -> TC: acessarTela()
activate TC

TC -> TC: exibirFormulario()
TC --> Administrador: formulário

Administrador -> TC: preencherDados(nome, email, senha, tipo)
TC -> TC: obterDados()

TC -> CC: cadastrarUsuario(dados)
activate CC

CC -> CC: validarDados(dados)

CC -> UR: findByEmail(email)
activate UR
UR --> CC: null
deactivate UR

== Padrão Factory: Criar Usuário ==

CC -> UF: criarUsuario(tipo, dados)
activate UF

note right of UF
  Factory cria instância
  concreta baseada no tipo:
  - ALUNO → new Aluno()
  - MOTORISTA → new Motorista()
  - SECRETARIA → new Secretaria()
end note

create U
UF -> U: new(dados)
note right: Instância concreta (Aluno, Motorista ou Secretaria)

UF --> CC: usuario
deactivate UF

CC -> UR: save(usuario)
activate UR
UR --> CC: usuarioSalvo
deactivate UR

CC --> TC: sucesso
deactivate CC

TC -> TC: exibirMensagemSucesso()
TC --> Administrador: "Usuário cadastrado com sucesso"
deactivate TC

@enduml

' ============================================
' JUSTIFICATIVA DOS PADRÕES NA SEQUÊNCIA
' ============================================
'
' GRASP Controller:
' - CadastroController recebe a requisição da boundary
'   e coordena o fluxo de cadastro.
'
' Factory (GoF):
' - UsuarioFactory encapsula a criação do usuário.
' - O controller solicita criarUsuario(tipo, dados)
' - A factory retorna Usuario (interface) mas cria
'   a instância concreta (Aluno, Motorista ou Secretaria)
'   baseada no parâmetro tipo.
' - O controller não conhece as classes concretas.
'
' Low Coupling:
' - TelaCadastro não conhece entidades diretamente.
' - CadastroController não conhece classes concretas,
'   apenas a interface Usuario.
'
' High Cohesion:
' - CadastroController: coordena cadastro
' - UsuarioFactory: cria usuários
' - UsuarioRepository: persiste usuários
