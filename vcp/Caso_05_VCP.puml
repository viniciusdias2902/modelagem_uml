@startuml
left to right direction

' ==========================================
' PADRÃO OBSERVER - IMPLEMENTAÇÃO CLÁSSICA
' ==========================================

interface Subject <<interface>> {
    +attach(observer: Observer)
    +detach(observer: Observer)
    +notify(evento: EventoRota)
}

interface Observer <<interface>> {
    +update(evento: EventoRota)
}

class EventoRota {
    -tipo: TipoEventoRota
    -rota: Rota
    -timestamp: DateTime
    +getTipo(): TipoEventoRota
    +getRota(): Rota
}

enum TipoEventoRota {
    ROTA_INICIADA
}

class NotificacaoAlunoObserver {
    +update(evento: EventoRota)
}

' ==========================================
' ECB
' ==========================================

class TelaControleRota <<boundary>> {
    +exibirRota(rota: Rota)
    +exibirBotaoIniciar()
    +exibirConfirmacao(mensagem: String)
    +exibirErro(mensagem: String)
}

class ServicoNotificacao <<boundary>> {
    +enviarNotificacao(destinatario: String, titulo: String, mensagem: String)
}

class IniciarRotaController <<controller>> {
    -observers: List<Observer>
    +attach(observer: Observer)
    +detach(observer: Observer)
    +notify(evento: EventoRota)
    +carregarRota(data: Date): Rota
    +iniciarRota(rota: Rota)
}

class Rota <<entity>> {
    -id: UUID
    -data: Date
    -status: StatusRota
    -horaInicio: DateTime
    +iniciar()
    +getStatus(): StatusRota
    +getAlunos(): List<Aluno>
}

class Aluno <<entity>> {
    -id: UUID
    -nome: String
    -email: String
    +getNome(): String
    +getEmail(): String
}

enum StatusRota <<entity>> {
    NAO_INICIADA
    EM_ANDAMENTO
    FINALIZADA
}

' ==========================================
' RELACIONAMENTOS
' ==========================================

IniciarRotaController ..|> Subject
NotificacaoAlunoObserver ..|> Observer

TelaControleRota --> IniciarRotaController
IniciarRotaController o--> "0..*" Observer : observers
IniciarRotaController --> Rota

NotificacaoAlunoObserver --> ServicoNotificacao
NotificacaoAlunoObserver --> Aluno
Observer ..> EventoRota

Rota --> "0..*" Aluno
Rota --> StatusRota
EventoRota --> TipoEventoRota
EventoRota --> Rota

@enduml

' ============================================
' JUSTIFICATIVA DOS PADRÕES APLICADOS
' ============================================
'
' PADRÕES DE ANÁLISE:
' - BCE (Boundary-Controller-Entity): Separação entre
'   interfaces (TelaControleRota, ServicoNotificacao),
'   lógica (IniciarRotaController) e dados (Rota, Aluno).
' - GRASP Controller: IniciarRotaController coordena o
'   fluxo de início da rota.
' - Information Expert: Rota conhece seus alunos e
'   gerencia seu próprio status através do método iniciar().
'
' PADRÕES DE PROJETO:
' - Observer (GoF): Implementação clássica.
'   - Subject: interface com attach/detach/notify
'   - Observer: interface com update(evento)
'   - ConcreteSubject: IniciarRotaController mantém lista
'     de observers e dispara notify() após iniciar rota
'   - ConcreteObserver: NotificacaoAlunoObserver reage ao
'     evento ROTA_INICIADA e usa ServicoNotificacao
'     (boundary) para notificar cada aluno da rota
'   - EventoRota: encapsula informações do evento
'
' JUSTIFICATIVA:
' O Observer é adequado pois múltiplos alunos precisam ser
' notificados quando a rota é iniciada. O padrão desacopla
' a lógica de início da rota da lógica de notificação,
' permitindo adicionar novos observers sem modificar o
' controller (ex: LogObserver, SMSObserver).